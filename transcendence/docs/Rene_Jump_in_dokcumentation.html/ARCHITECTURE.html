<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ft_transcendence - Projekt Dokumentation</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    .mermaid { background: white; padding: 20px; border-radius: 8px; }
  </style>
</head>
<body class="bg-gray-50">
  <div class="max-w-6xl mx-auto p-8">
    <h1 class="text-4xl font-bold mb-6">ðŸŽ® ft_transcendence</h1>
    <p class="text-gray-600 mb-8">Projekt-Architektur & Dokumentation</p>

    <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
      <h2 class="text-2xl font-bold mb-4">Service Communication</h2>
      <div class="mermaid">
        graph TB
          Browser[Browser] --> Frontend[Frontend SPA]
          Frontend --> Gateway[API Gateway]
          Gateway --> UserSvc[User Service]
          Gateway --> GameSvc[Game Service]
          Gateway --> TournamentSvc[Tournament Service]
          UserSvc --> DB[(SQLite Database)]
          GameSvc --> DB
          TournamentSvc --> DB
          UserSvc -.log.-> LogSvc[Log Service]
          GameSvc -.log.-> LogSvc
          TournamentSvc -.log.-> LogSvc
          LogSvc --> DB
      </div>
    </div>

    <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
      <h2 class="text-2xl font-bold mb-4">Backend Dependencies</h2>
      <div class="mermaid">
        graph LR
          Gateway[gateway/index.ts] --> Routes[routes.ts]
          Gateway --> Health[health.route.ts]
          Gateway --> WS[ws-proxy.route.ts]
          Gateway --> UserRoute[user.route.ts]
          UserRoute --> UserSvc[User Service]
          UserSvc --> AuthCtrl[authController.js]
          UserSvc --> AuthMw[authMiddleware.js]
          AuthCtrl --> AuthSvc[authService.js]
          AuthCtrl --> UserModel[User.js]
          AuthSvc --> DBConfig[database.js]
          UserModel --> DBConfig
          DBConfig --> SQLite[(SQLite)]
      </div>
    </div>

    <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
      <h2 class="text-2xl font-bold mb-4">Frontend Dependencies</h2>
      <div class="mermaid">
        graph TB
          Main[main.ts] --> Styles[styles.css]
          Main --> Router[router.ts]
          Router --> Guards[guards.ts]
          Router --> Auth[auth.ts]
          Router -.lazy load.-> Game[game.ts]
          Router -.lazy load.-> Lobby[lobby.ts]
          Router -.lazy load.-> Tournaments[tournaments.ts]
          Game --> GameLogic[game/logic.ts]
          Game --> GameState[game/state.ts]
          Game --> GameInput[game/input.ts]
          GameLogic --> GameState
      </div>
    </div>

    <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
      <h2 class="text-2xl font-bold mb-4">Database Schema</h2>
      <div class="mermaid">
        erDiagram
          USERS ||--o{ USER_STATS : has
          USERS ||--o{ GAMES : plays
          USERS ||--o{ TOURNAMENT_PLAYERS : participates
          TOURNAMENTS ||--o{ TOURNAMENT_PLAYERS : has
          
          USERS {
            int id PK
            string username UK
            string email UK
            string password_hash
            string display_name
            boolean is_two_factor_auth_enabled
          }
          
          GAMES {
            int id PK
            int player1_id FK
            int player2_id FK
            int winner_id FK
            string status
          }
          
          TOURNAMENTS {
            int id PK
            string name
            string bracket
            string status
          }
      </div>
    </div>

    <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
      <h2 class="text-2xl font-bold mb-4">User Login Flow</h2>
      <div class="mermaid">
        sequenceDiagram
          participant B as Browser
          participant F as Frontend
          participant G as Gateway
          participant U as User Service
          participant D as Database
          
          B->>F: POST /api/auth/login
          F->>G: fetch request
          G->>U: proxy
          U->>D: SELECT user
          D-->>U: user data
          U->>U: verify password
          U->>U: generate JWT
          U-->>G: token + user
          G-->>F: response
          F-->>B: redirect to lobby
      </div>
    </div>

    <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
      <h3 class="font-bold text-blue-900 mb-2">ðŸ“š Weitere Dokumentation</h3>
      <ul class="list-disc list-inside text-blue-800 space-y-1">
        <li>Architecture Documentation: <code>docs/architecture.md</code></li>
        <li>API Contracts: <code>docs/api-contracts.md</code></li>
        <li>Tournament Flow: <code>docs/tournament_flow.md</code></li>
        <li>Deployment Guide: <code>docs/deployment.md</code></li>
      </ul>
    </div>
  </div>

  <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
  <h1 class="text-2xl font-bold mb-4">NEUES DIAGRMM</h>
  <div class="mermaid">
    graph LR
      A[Start] --> B[End]
  </div>
</div>

  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ 
      startOnLoad: true,
      theme: 'default',
      securityLevel: 'loose',
    });
  </script>
</body>
</html>